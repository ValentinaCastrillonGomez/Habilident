<form [formGroup]="formatForm">
    <div class="my-2">
        <mat-form-field appearance="outline" class="w-full">
            <mat-label>Nombre del formato</mat-label>
            <input matInput type="text" id="name" formControlName="name" required>
            @if (formatForm.controls.name.invalid) {
            <mat-error>Introduce un nombre válido</mat-error>
            }
        </mat-form-field>

        <section formArrayName="rows">
            <div class="flex items-center justify-between">
                <span class="font-bold">Campos</span>
                <div>
                    <button mat-button type="button" (click)="addRow('single')">
                        <mat-icon>add</mat-icon>Añadir fila de campos
                    </button>
                    <button mat-button type="button" (click)="addRow('table')">
                        <mat-icon>add</mat-icon>Añadir tabla
                    </button>
                </div>
            </div>
            <div cdkDropList (cdkDropListDropped)="drop($event)">
                @for (row of formatForm.controls.rows.controls; track $index) {
                <app-format-row [row]="row" (remove)="removeRow($index)"></app-format-row>
                }
            </div>
        </section>
    </div>
    <section class="flex justify-end space-x-1">
        <button mat-stroked-button type="submit" matStepperNext>Siguiente</button>
    </section>
</form>